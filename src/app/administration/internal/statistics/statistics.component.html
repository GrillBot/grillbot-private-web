<app-modal [title]="header">
    <table class="table table-sm table-bordered table-striped auto-column-width" *ngIf="isStatLike">
        <thead>
            <tr>
                <th *ngIf="isTextCommands || isInteractions">Příkaz</th>
                <th *ngIf="isJobs">Název úlohy</th>
                <th *ngIf="isApiRequestsByEndpoint">Endpoint</th>
                <th>Poslední volání</th>
                <th>Úspěšných</th>
                <th>Chybných</th>
                <th>Úspěšnost</th>
                <th>Min. doba běhu</th>
                <th>Max. doba běhu</th>
                <th>Celk. doba běhu</th>
                <th>Prům. doba běhu</th>
            </tr>
        </thead>

        <tbody>
            <ng-container *ngIf="statItemsQuery | async as result; else loading_table">
                <tr *ngFor="let item of result" [class.bg-warning]="item.successRate > 25 && item.successRate < 50"
                    [class.bg-danger]="item.successRate <= 25">
                    <td [title]="item.key">{{item.key | cut:35}}</td>
                    <td>{{item.last.binding}}</td>
                    <td>{{item.successCount}}</td>
                    <td>{{item.failedCount}}</td>
                    <td>{{item.successRate}} %</td>
                    <td>{{item.minDuration}} ms</td>
                    <td>{{item.maxDuration}} ms</td>
                    <td>{{item.totalDuration}} ms</td>
                    <td>{{item.avgDuration}} ms</td>
                </tr>
            </ng-container>
        </tbody>
    </table>

    <app-line-chart [data]="dictQuery | async" *ngIf="canLineChart"></app-line-chart>
    <app-bar-chart [data]="dictQuery | async" *ngIf="canBarChart"></app-bar-chart>

    <ng-container *ngIf="isList">
        <ul *ngIf="listQuery | async as result; else loading">
            <li *ngFor="let item of result"><code class="text-dark">{{item}}</code></li>
        </ul>
    </ng-container>
</app-modal>

<ng-template #loading_table>
    <tr>
        <td colspan="9">
            <app-loading></app-loading>
        </td>
    </tr>
</ng-template>

<ng-template #loading>
    <app-loading></app-loading>
</ng-template>
